{% extends "base.html" %}
{% load humanize %}

{% block title %}Dashboard â€“ MyJudge{% endblock %}

{% block content %}
  <h1 class="mb-4">Dashboard</h1>

  <!-- Problems List -->
  <div class="card mb-4">
    <div class="card-header">Available Problems</div>
    <ul class="list-group list-group-flush">
      {% for p in problems %}
        <li class="list-group-item">
          <a href="{% url 'dashboard:problem_detail' p.id %}">{{ p.title }}</a>
          <span class="badge bg-secondary float-end">{{ p.created_at|date:"M d, Y" }}</span>
        </li>
      {% empty %}
        <li class="list-group-item">No problems have been created yet.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Submissions Table -->
  <div class="card">
    <div class="card-header">Your Submissions</div>
    <div class="table-responsive">
      <table class="table table-striped mb-0">
        <thead>
          <tr>
            <th>Problem</th>
            <th>Lang</th>
            <th>Status</th>
            <th>Details</th>
            <th>When</th>
          </tr>
        </thead>
        <tbody>
          {% for s in submissions %}
            <tr>
              <td>{{ s.problem.title }}</td>
              <td>{{ s.get_language_display }}</td>
              <td>
                {% if s.status == 'A' %}
                  <span class="badge bg-success">{{ s.get_status_display }}</span>
                {% elif s.status == 'R' %}
                  <span class="badge bg-danger">{{ s.get_status_display }}</span>
                {% elif s.status == 'T' %}
                  <span class="badge bg-warning text-dark">{{ s.get_status_display }}</span>
                {% else %}
                  <span class="badge bg-secondary">{{ s.get_status_display }}</span>
                {% endif %}
              </td>
              <td>
                {% if s.verdict_details %}
                  <pre class="mb-0">{{ s.verdict_details }}</pre>
                {% else %}
                  &ndash;
                {% endif %}
              </td>
              <td>{{ s.submitted_at|naturaltime }}</td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="5" class="text-center">You haven't submitted any solutions yet.</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}
